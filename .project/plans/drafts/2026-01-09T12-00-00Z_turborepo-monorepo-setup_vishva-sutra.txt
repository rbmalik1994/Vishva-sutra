Prompt-Name: turborepo-monorepo-setup
Project: vishva-sutra
Author: GitHub Copilot (prompt-builder)
Created-At: 2026-01-09T12:00:00Z
Sources: user-requirements, repository context
Version: 0.1.0
Status: draft

--PROMPT:

Scaffold a minimal Turborepo monorepo for a Todo/Notes app using pnpm workspaces, TypeScript, React, Tailwind CSS, and a custom Tailwind-based UI package (shadcn-like) with theming and accessibility in mind.

Overview

Package manager: pnpm workspaces (root package.json uses workspaces and pnpm-friendly scripts).
Monorepo orchestration: Turborepo.
Apps: React + Vite apps using TanStack libraries (Router / Query) instead of Next.js.
UI package: Tailwind-powered library in packages/ui with CSS-variable theming, ThemeProvider, useTheme, and accessible components.
Shared config: configs/ (tsconfig.base, tailwind base, eslint/prettier).
Scope: only what is necessary for a Todo/Notes experience (capture, list, edit, persist, theme toggle) with API optionally stubbed for CRUD.

Architecture & Design (Todo/Notes-focused)

- **High-level diagram (textual):**
	- Client (apps/web) → CDN → Edge/Load Balancer → API (apps/api) → datastore (notes/todos table or document store)
	- Optional: apps/cli for quick capture via terminal; apps/sdk consumed by web/cli to share typed API calls.

- **Components & responsibilities (minimal set):**
	- `apps/web`: Vite + React + TanStack Router/Query single-page app for listing/creating/updating notes/todos, theme toggle.
	- `apps/api` (optional but recommended): small Fastify/Express service exposing CRUD endpoints for notes/todos; stateless; validates input.
	- `apps/cli` (optional): Node + TypeScript CLI that calls `apps/api` or local storage for quick capture.
	- `packages/ui`: design system primitives (Button, Input/Textarea, Card, Modal/Sheet), theme utilities, focus-visible styles.
	- `packages/assets`: shared icons/fonts (optional, only if used by UI).
	- `configs/`: centralized tsconfig/tailwind/postcss/eslint.
	- `libs/interfaces`: shared DTOs/types for notes/todos between API, SDK, and web.
	- `apps/sdk`: thin typed client for the API (fetch wrapper) reused by web/cli.

- **Data flow (Todo/Notes):**
	1. User opens `apps/web`; app loads theme preference from localStorage (pre-hydration inline script sets data-theme).
	2. Web app fetches notes/todos via SDK → API; TanStack Query caches results and handles mutations.
	3. API validates and persists to datastore (can start with in-memory or file-based for scaffold).
	4. UI renders list, filters, and detail; uses accessible controls with focus states and ARIA labels.

- **Technology choices & rationale (kept minimal):**
	- Vite + React for fast DX and small bundles.
	- TanStack Router + Query for client routing/state; no SSR needed.
	- Turborepo + pnpm for workspace orchestration and caching.
	- Tailwind + CSS variables for theming without locking to a framework.
	- Optional API to enable persistence beyond localStorage; start with stub for scaffold.

- **Deployment & infra (minimal path):**
	- Deploy `apps/web` as static assets to CDN-backed host (Netlify/Vercel/Cloudflare Pages).
	- If `apps/api` is used, containerize and deploy to a small serverless/container runtime; keep stateless.

- **Security & data handling (focused):**
	- No secrets in repo; use env vars for API keys.
	- Input validation on API for note/todo content and IDs; sanitize user input for display.

- **Observability (lightweight):**
	- Basic request logging in API; optional metrics stub.

- **Implementation roadmap (phases):**
	1) Init repo: root manifests (`package.json`, `pnpm-workspace.yaml`, `turbo.json`, `tsconfig.base.json`), `configs/` skeleton.
	2) Build `packages/ui` (Button, Input/Textarea, Card, Modal) + theming + focus-visible.
	3) Scaffold `apps/web` with note/todo list + create/edit flows; integrate theme toggle and skip link.
	4) Optional: scaffold `apps/api` CRUD stub + `apps/sdk` fetch wrapper; wire web to SDK.
	5) Tests/lint/CI; minimal Vitest examples for `packages/ui` Button keyboard activation.

- **Decision records & tradeoffs (kept):**
	- Client-only rendering accepted for speed; can add API later for multi-device sync.
	- CSS variables over heavier theming libs to keep bundle small and cross-platform.

Workspace layout (Todo/Notes minimal, placeholders optional)

apps/
	web/      — main todo/notes SPA (React + Vite + TanStack Router/Query)
	api/      — optional CRUD API (Fastify/Express + TS)
	cli/      — optional capture CLI
	sdk/      — optional typed SDK for API
	SubApps/  — optional future sub-apps
configs/    — shared configuration files (tsconfig.base.json, tailwind.shared.js, eslint, etc.)
docs/       — documentation (keep minimal)
libs/       — shared libraries (e.g., interfaces/)
tools/      — tooling scripts/utilities (only if needed)
extensions/ — app-specific extensions (optional)
packages/
	assets/   — UI assets (only if used)
	ui/       — UI component library (the shadcn-like package)
	interface/— shared TypeScript interfaces (if needed)
scripts/    — utility scripts for repo setup/management (keep lean)
.github/    — CI/workflow stubs (optional minimal CI)
package.json (root) + turbo.json + pnpm-workspace.yaml + tsconfig.base.json
Constraints & requirements

Use pnpm as the package manager; root commands and examples must use pnpm.
Use Turborepo for pipelines; configure turbo.json for dev, build, lint, typecheck tasks.
Use TypeScript 5.x and target ES2022.
Use Tailwind CSS v3+ with PostCSS and autoprefixer.
Use React + Vite for apps. Use TanStack Router for routing and TanStack Query for data fetching patterns (no Next.js).
UI package must be framework-agnostic where possible (CSS variables + Tailwind), consumable from Vite/React apps.
Accessibility: follow WCAG 2.2 Level AA guidance (keyboard navigation, focus visible, skip links, ARIA where needed). Note: must still be manually tested.
The theme system must persist user preference in localStorage and set a pre-hydration inline script that applies theme class/data attribute before React hydrates.
Root files to specify in the prompt

package.json (root): pnpm workspaces config or pnpm-workspace.yaml plus scripts:
dev: turbo run dev --parallel
build: turbo run build
start: turbo run start
lint: turbo run lint
typecheck: turbo run typecheck
pnpm-workspace.yaml: include apps/*, packages/*, configs/*, libs/*, tools/*
turbo.json: pipeline that caches builds, runs build in packages before apps, dev runs apps in parallel
tsconfig.base.json: base config with paths mapping @vishva-sutra/ui to packages/ui/src
Shared config files under configs/ (Tailwind shared, PostCSS, ESLint)
Apps (Vite + TanStack) requirements — minimal todo/notes

- apps/web: Vite + React + TypeScript template; TanStack Router for routes, TanStack Query for CRUD data.
- Each app must have: package.json with dev, build, preview, lint, typecheck; vite.config.ts; index.html; src/main.tsx; src/App.tsx.
- tailwind.config.cjs should import shared config from configs/tailwind.shared.cjs (or require relative path).
- postcss.config.cjs referencing Tailwind and autoprefixer.
- Implement a global skip-to-main link (visible on focus) and focus-visible styles.
- Example in apps/web: list of todos/notes, add/edit form, uses @vishva-sutra/ui Button/Input/Card, theme toggle persists (localStorage + pre-hydration inline script).
packages/ui (UI library) requirements — minimal set

- TypeScript package with:
	- packages/ui/package.json with name: @vishva-sutra/ui, exports, types, build script (tsc --build or tsup suggestion)
	- src/index.ts exporting named components and types
	- src/components/Button.tsx, Input.tsx (or Textarea), Card.tsx, Modal.tsx (minimal accessible implementations)
	- src/theme/ThemeProvider.tsx, useTheme.ts implementing CSS-variable theming and localStorage persistence and pre-hydration inline script guidance
- Accessibility requirements:
	- Keyboard operable, ARIA attributes when necessary, focus ring styles that meet contrast guidelines, don't use color alone to convey state
- Theming:
	- Provide CSS variable tokens and Tailwind integration so apps can override variables
	- Expose a minimal API for theme switching and a server-friendly pre-hydration script pattern
configs (shared configs) requirements

configs/tailwind.shared.cjs or tailwind.config.js exporting theme tokens and accessible color palettes
configs/postcss.config.cjs
configs/tsconfig.base.json (referenced by tsconfig.json in workspaces)
Optional configs/eslint and configs/prettier stubs following React/Ts recommendations

Commands / Developer validation steps (explicit pnpm usage)

Install and run dev:
```bash
pnpm install
# run turbo dev across workspaces (root script)
pnpm dev
# or explicitly run turbo in the workspace
pnpm -w dev
```

Build and lint:
```bash
pnpm -w build
pnpm -w lint
pnpm -w typecheck
```

Preview a built app (example):
```bash
# from an app folder, after build:
pnpm --filter apps/web preview
```
Success criteria (must be testable)

pnpm dev boots the apps (e.g., apps/web) and the example page renders without runtime errors.
The homepage demonstrates @vishva-sutra/ui Button and theme toggle working and persisting after reloads (check localStorage and applied class/data attribute).
pnpm build completes for all workspaces without TypeScript project errors.
pnpm lint reports zero critical lint errors.
Accessibility basics present: skip link, buttons have accessible names, focus ring visible when tabbing.
Validation checklist to include in the prompt

Root package.json / pnpm-workspace.yaml defines workspaces and pnpm usage.
turbo.json pipeline exists and builds packages before apps.
apps/web is a Vite + React + TanStack Router app and imports @vishva-sutra/ui.
packages/ui exports Button and ThemeProvider with TypeScript types.
Theme toggle persists and works before hydration (pre-hydration snippet described).
Accessibility basics implemented: skip link, visible focus, aria labels.
pnpm build succeeds across workspaces.
Testing, types, CI notes

Provide typecheck scripts and recommend tsconfig project references.
Suggest testing stack: Vitest or Jest + Testing Library for components in packages/ui; include one suggested test idea for keyboard activation of Button.
Suggest a CI pipeline stub using .github/workflows/ci.yml that runs pnpm install, pnpm lint, pnpm build, pnpm test.
Deliverable format (what to output/commit)

A clear plan describing:
exact files to create and their purpose,
package.json scripts and pnpm usage,
example Vite/TanStack app layout and minimal code examples,
packages/ui API and theme approach,
commands to validate and the validation checklist above.
No actual implementation required by this prompt — this is a generation prompt for a scaffold generator. The output should be commit-ready instructions and file list.
Example usage snippet for apps/web/src/main.tsx (must work conceptually)

Example minimal App.tsx demonstrating Button and skip link

Notes / Edge cases / Clarifications

If implementer prefers pnpm workspaces they should use pnpm-workspace.yaml. This prompt requires pnpm.
TanStack means using TanStack Router and TanStack Query for routing and data fetching; SSR frameworks like Next.js are explicitly excluded.
Keep UI package tree-shakeable with named exports.
Keep theming via CSS variables so packages/ui can be consumed in non-React contexts.
Accessibility guidance: follow WCAG 2.2 AA; recommend running Accessibility Insights or Lighthouse for manual checks.
Output Format

Provide a single, cohesive scaffold-generation prompt (plain text) that an automated generator or developer can follow to create the monorepo exactly as specified.
Include:
exact file/folder list,
key file templates to create (names + short description),
root and workspace scripts (commands),
validation checklist and commands,
small code examples shown above.
Examples

See the Example usage snippet and Example minimal App.tsx above for minimal integration examples.


END PROMPT
